
import 'package:cloud_functions/cloud_functions.dart';
import 'package:flutter/material.dart';
import 'package:iconsax/iconsax.dart';
import 'package:lottie/lottie.dart';

// import 'package:purchases_flutter/purchases_flutter.dart';
import 'package:shared_preferences/shared_preferences.dart';
import 'package:stylestore/Utilities/constants/user_constants.dart';
import 'package:stylestore/controllers/home_page_controllers/home_controller_mobile.dart';
import 'package:stylestore/screens/analytics/loading_analysis_page.dart';

import '../../Utilities/constants/color_constants.dart';
import '../../Utilities/constants/font_constants.dart';
import '../../controllers/responsive/responsive_page.dart';



class AnalysisIntroPage extends StatefulWidget {
  @override
  State<AnalysisIntroPage> createState() => _AnalysisIntroPageState();
}

class _AnalysisIntroPageState extends State<AnalysisIntroPage> {
  var textColor = kBlack;

  var backgroundColor = kPureWhiteColor;
  final HttpsCallable callableCreateStoreAnalysis = FirebaseFunctions.instance.httpsCallable('createStoreAnalysis');

  bool isLoading = false;
  var storeName = "";
  var storeId = "";
//   String data = '[{"items":"[{product: Fresh Juice, quantity: 1.0, totalPrice: 10000.0, description: Juice}]","date":"Thursday, July, 2023, 12:00 AM","total":"10000.0","client":"Customer"},{"items":"[{product: Fresh Juice, quantity: 4, totalPrice: 10000, description: Juice}, {product: 5 day detox (1L), quantity: 1, totalPrice: 60000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 06:43 PM","total":"70000.0","client":"Madam Carol"},{"items":"[{product: Chicken Salad, quantity: 3, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 07:56 PM","total":"18000.0","client":"Customer"},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 08:32 PM","total":"18000.0","client":"Madam Carol"},{"items":"[{product: 1L Detox Juice , quantity: 2, totalPrice: 12000, description: Detoxification }, {product: 1L Detox Juice , quantity: 1, totalPrice: 10000, description: Detoxification }]","date":"Wednesday, July, 2023, 07:18 PM","total":"22000.0","client":"Mrs. Sebaalu"},{"items":"[{product: 5 day detox (1L), quantity: 2, totalPrice: 62000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 08:32 PM","total":"62000.0","client":"Barbara Uba "},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 days of detox 2L per day}]","date":"Thursday, July, 2023, 12:30 PM","total":"110000.0","client":"Jamila"},{"items":"[{product: Fresh Juice, quantity: 1.0, totalPrice: 10000.0, description: Juice}]","date":"Thursday, July, 2023, 12:00 AM","total":"10000.0","client":"Customer"},{"items":"[{product: Fresh Juice, quantity: 4, totalPrice: 10000, description: Juice}, {product: 5 day detox (1L), quantity: 1, totalPrice: 60000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 06:43 PM","total":"70000.0","client":"Madam Carol"},{"items":"[{product: Chicken Salad, quantity: 3, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 07:56 PM","total":"18000.0","client":"Customer"},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 08:32 PM","total":"18000.0","client":"Madam Carol"},{"items":"[{product: 1L Detox Juice , quantity: 2, totalPrice: 12000, description: Detoxification }, {product: 1L Detox Juice , quantity: 1, totalPrice: 10000, description: Detoxification }]","date":"Wednesday, July, 2023, 07:18 PM","total":"22000.0","client":"Mrs. Sebaalu"},{"items":"[{product: 5 day detox (1L), quantity: 2, totalPrice: 62000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 08:32 PM","total":"62000.0","client":"Barbara Uba "},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 days of detox 2L per day}]","date":"Thursday, July, 2023, 12:30 PM","total":"110000.0","client":"Jamila"},{"items":"[{product: Fresh Juice, quantity: 1.0, totalPrice: 10000.0, description: Juice}]","date":"Thursday, July, 2023, 12:00 AM","total":"10000.0","client":"Customer"},'
   //    '{"items":"[{product: Fresh Juice, quantity: 4, totalPrice: 10000, description: Juice}, {product: 5 day detox (1L), quantity: 1, totalPrice: 60000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 06:43 PM","total":"70000.0","client":"Madam Carol"},{"items":"[{product: Chicken Salad, quantity: 3, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 07:56 PM","total":"18000.0","client":"Customer"},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 08:32 PM","total":"18000.0","client":"Madam Carol"},{"items":"[{product: 1L Detox Juice , quantity: 2, totalPrice: 12000, description: Detoxification }, {product: 1L Detox Juice , quantity: 1, totalPrice: 10000, description: Detoxification }]","date":"Wednesday, July, 2023, 07:18 PM","total":"22000.0","client":"Mrs. Sebaalu"},{"items":"[{product: 5 day detox (1L), quantity: 2, totalPrice: 62000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 08:32 PM","total":"62000.0","client":"Barbara Uba "},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 days of detox 2L per day}]","date":"Thursday, July, 2023, 12:30 PM","total":"110000.0","client":"Jamila"},{"items":"[{product: Fresh Juice, quantity: 1.0, totalPrice: 10000.0, description: Juice}]","date":"Thursday, July, 2023, 12:00 AM","total":"10000.0","client":"Customer"},{"items":"[{product: Fresh Juice, quantity: 4, totalPrice: 10000, description: Juice}, {product: 5 day detox (1L), quantity: 1, totalPrice: 60000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 06:43 PM","total":"70000.0","client":"Madam Carol"},{"items":"[{product: Chicken Salad, quantity: 3, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 07:56 PM","total":"18000.0","client":"Customer"},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 08:32 PM","total":"18000.0","client":"Madam Carol"},{"items":"[{product: 1L Detox Juice , quantity: 2, totalPrice: 12000, description: Detoxification }, {product: 1L Detox Juice , quantity: 1, totalPrice: 10000, description: Detoxification }]","date":"Wednesday, July, 2023, 07:18 PM","total":"22000.0","client":"Mrs. Sebaalu"},{"items":"[{product: 5 day detox (1L), quantity: 2, totalPrice: 62000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 08:32 PM","total":"62000.0","client":"Barbara Uba "},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 days of detox 2L per day}]","date":"Thursday, July, 2023, 12:30 PM","total":"110000.0","client":"Jamila"},{"items":"[{product: Fresh Juice, quantity: 1.0, totalPrice: 10000.0, description: Juice}]","date":"Thursday, July, 2023, 12:00 AM","total":"10000.0","client":"Customer"},{"items":"[{product: Fresh Juice, quantity: 4, totalPrice: 10000, description: Juice}, {product: 5 day detox (1L), quantity: 1, totalPrice: 60000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 06:43 PM","total":"70000.0","client":"Madam Carol"},{"items":"[{product: Chicken Salad, quantity: 3, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 07:56 PM","total":"18000.0","client":"Customer"},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 08:32 PM","total":"18000.0","client":"Madam Carol"},'
  //     '{"items":"[{product: 1L Detox Juice , quantity: 2, totalPrice: 12000, description: Detoxification }, {product: 1L Detox Juice , quantity: 1, totalPrice: 10000, description: Detoxification }]","date":"Wednesday, July, 2023, 07:18 PM","total":"22000.0","client":"Mrs. Sebaalu"},{"items":"[{product: 5 day detox (1L), quantity: 2, totalPrice: 62000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 08:32 PM","total":"62000.0","client":"Barbara Uba "},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 days of detox 2L per day}]","date":"Thursday, July, 2023, 12:30 PM","total":"110000.0","client":"Jamila"},{"items":"[{product: Fresh Juice, quantity: 1.0, totalPrice: 10000.0, description: Juice}]","date":"Thursday, July, 2023, 12:00 AM","total":"10000.0","client":"Customer"},{"items":"[{product: Fresh Juice, quantity: 4, totalPrice: 10000, description: Juice}, {product: 5 day detox (1L), quantity: 1, totalPrice: 60000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 06:43 PM","total":"70000.0","client":"Madam Carol"},{"items":"[{product: Chicken Salad, quantity: 3, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 07:56 PM","total":"18000.0","client":"Customer"},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Wednesday, July, 2023, 08:32 PM","total":"18000.0","client":"Madam Carol"},{"items":"[{product: 1L Detox Juice , quantity: 2, totalPrice: 12000, description: Detoxification }, {product: 1L Detox Juice , quantity: 1, totalPrice: 10000, description: Detoxification }]","date":"Wednesday, July, 2023, 07:18 PM","total":"22000.0","client":"Mrs. Sebaalu"},{"items":"[{product: 5 day detox (1L), quantity: 2, totalPrice: 62000, description: 5 day detox 1L per day}]","date":"Wednesday, July, 2023, 08:32 PM","total":"62000.0","client":"Barbara Uba "},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 days of detox 2L per day}]","date":"Thursday, July, 2023, 12:30 PM","total":"110000.0","client":"Jamila"},{"items":"[{product: Fresh Juice, quantity: 1, totalPrice: 10000, description: Juice}]","date":"Thursday, July, 2023, 02:13 PM","total":"10000.0","client":"Customer"},{"items":"[{product: Fresh Juice, quantity: 1, totalPrice: 10000, description: Juice}, {product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Thursday, July, 2023, 03:02 AM","total":"28000.0","client":"Mrs. Sebaalu"},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Thursday, July, 2023, 02:38 PM","total":"18000.0","client":"Customer"},{"items":"[{product: Chicken Salad, quantity: 6, totalPrice: 18000, description: a nice chicken salad}]","date":"Friday, July, 2023, 09:36 PM","total":"18000.0","client":"Jeremiah "},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Friday, July, 2023, 05:47 PM","total":"18000.0","client":"Madam Carol"},{"items":"[{product: Fresh Juice, quantity: 1, totalPrice: 12000, description: Juice}]","date":"Friday, July, 2023, 11:02 PM","total":"12000.0","client":"Barbara Uba "},{"items":"[{product: Fresh Juice, quantity: 2, totalPrice: 10000, description: Juice}]","date":"Friday, July, 2023, 06:11 PM","total":"10000.0","client":"Barbara Uba "},{"items":"[{product: Chicken Salad, quantity: 3, totalPrice: 18000, description: a nice chicken salad}, {product: Chicken Salad, quantity: 2, totalPrice: 18000, description: a nice chicken salad}]","date":"Friday, July, 2023, 10:42 PM","total":"36000.0","client":"Lynn (URA)"} {"items":"[{product: Chicken Salad, quantity: 2, totalPrice: 18000, description: a nice chicken salad}]","date":"Friday, July, 2023, 06:08 PM","total":"18000.0","client":"Jeremiah "},{"items":"[{product: Chicken Salad, quantity: 4, totalPrice: 18000, description: a nice chicken salad}]","date":"Saturday, July, 2023, 12:40 PM","total":"18000.0","client":"Lynn (URA)"},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Saturday, July, 2023, 11:20 PM","total":"18000.0","client":"Lynn (URA)"},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 days of detox 2L per day}]","date":"Monday, July, 2023, 08:34 AM","total":"110000.0","client":"Ethel "},{"items":"[{product: 5 day detox (1L), quantity: 1, totalPrice: 60000, description: 5 day detox 1L per day}]","date":"Monday, July, 2023, 08:43 AM","total":"60000.0","client":"Lynn (Public Service)"},{"items":"[{product: 1L Detox Juice , quantity: 2, totalPrice: 10000, description: Detoxification }, {product: Delivery, quantity: 2, totalPrice: 2000, description: Delivery fee}]","date":"Monday, July, 2023, 08:33 AM","total":"12000.0","client":"Ashley"},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 days of detox 2L per day}]","date":"Monday, July, 2023, 08:31 AM","total":"110000.0","client":"Sylvia Ssesaazi"},{"items":"[{product: 1L Juice, quantity: 1, totalPrice: 10000, description: Natural Juice }, {product: Delivery, quantity: 1, totalPrice: 5000, description: Delivery fee}]","date":"Monday, July, 2023, 08:46 AM","total":"15000.0","client":"Lynn ( URA)"},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 days of detox 2L per day}]","date":"Monday, July, 2023, 08:27 AM","total":"110000.0","client":"Beatrice URA "},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: a nice chicken salad}]","date":"Tuesday, July, 2023, 10:47 PM","total":"18000.0","client":"Bernard Kangave"},{"items":"[{product: Delivery, quantity: 1, totalPrice: 2000, description: Delivery fee}]","date":"Tuesday, July, 2023, 10:45 PM","total":"2000.0","client":"Bernard Kangave"},{"items":"[{product: 1L Juice, quantity: 1, totalPrice: 10000, description: Natural Juice }, {product: Delivery, quantity: 1, totalPrice: 5000, description: Delivery fee}]","date":"Wednesday, July, 2023, 10:45 AM","total":"15000.0","client":"Lynn ( URA)"},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 days of detox 2L per day}]","date":"Wednesday, July, 2023, 10:49 AM","total":"110000.0","client":"Laura Dewaste"},{"items":"[{product: 1L Juice, quantity: 1, totalPrice: 10000, description: Natural Juice }]","date":"Wednesday, July, 2023, 05:37 PM","total":"10000.0","client":"Hatima (Nabukeera)"},{"items":"[{product: 1L Detox Juice , quantity: 2, totalPrice: 10000, description: Detoxification }, {product: Delivery, quantity: 1, totalPrice: 2000, description: Delivery fee}]","date":"Thursday, July, 2023, 09:14 AM","total":"12000.0","client":"Noah "},{"items":"[{product: 1L Juice, quantity: 2, totalPrice: 10000, description: Natural Juice }, {product: Delivery, quantity: 2, totalPrice: 5000, description: Delivery fee}]","date":"Thursday, July, 2023, 10:23 AM","total":"15000.0","client":"Lynn ( URA)"},{"items":"[{product: 1L Juice, quantity: 1, totalPrice: 10000, description: Natural Juice }, {product: Delivery, quantity: 1, totalPrice: 3000, description: Delivery fee}]","date":"Friday, July, 2023, 10:45 AM","total":"13000.0","client":"Doreen Atukunda"},{"items":"[{product: 1L Detox Juice , quantity: 2, totalPrice: 10000, description: Detoxification }]","date":"Friday, July, 2023, 02:47 PM","total":"10000.0","client":"Noah "},{"items":"[{product: 1L Juice, quantity: 1, totalPrice: 10000, description: Natural Juice }, {product: Delivery, quantity: 1, totalPrice: 5000, description: Delivery fee}]","date":"Monday, July, 2023, 12:05 PM","total":"15000.0","client":"Lynn ( URA)"},{"items":"[{product: 1L Juice, quantity: 2, totalPrice: 10000, description: Natural Juice }]","date":"Monday, July, 2023, 09:48 AM","total":"10000.0","client":"Noah "},{"items":"[{product: Fruit Salad , quantity: 1, totalPrice: 10000, description: fruits }, {product: 1L Juice, quantity: 1, totalPrice: 10000, description: Natural Juice }, {product: Delivery, quantity: 1, totalPrice: 5000, description: Delivery fee}]","date":"Monday, July, 2023, 03:00 AM","total":"25000.0","client":"Ashley"},{"items":"[{product: 1L for 5days, quantity: 1, totalPrice: 50000, description: 1L detox daily }]","date":"Monday, July, 2023, 12:44 PM","total":"50000.0","client":"Hatima (Nabukeera)"},{"items":"[{product: 1L for 5days, quantity: 1, totalPrice: 60000, description: 1L detox daily }]","date":"Monday, July, 2023, 12:32 PM","total":"60000.0","client":"Sylvia Ssesaazi"},{"items":"[{product: 5 day detox (1L), quantity: 3, totalPrice: 60000, description: 5 day detox 1L per day}]","date":"Monday, July, 2023, 10:40 AM","total":"60000.0","client":"Customer"},{"items":"[{product: 2L for 1 day , quantity: 1.0, totalPrice: 20000.0, description: Monday 10th July}, {product: 2L for 1 day , quantity: 1.0, totalPrice: 20000.0, description: Tuesday 11th July}, {product: 2L for 1 day , quantity: 1.0, totalPrice: 20000.0, description: Wednesday 12th July}, {product: 2L for 1 day , quantity: 1.0, totalPrice: 20000.0, description: Wednesday 26th July}]","date":"Friday, July, 2023, 01:11 PM","total":"80000.0","client":"Carol"},{"items":"[{product: 1L Juice, quantity: 1.0, totalPrice: 10000.0, description: Natural Juice }]","date":"Thursday, July, 2023, 12:00 AM","total":"10000.0","client":"Customer"},{"items":"[{product: 1L Juice, quantity: 5.0, totalPrice: 12000.0, description: Natural Juice }]","date":"Monday, July, 2023, 01:49 PM","total":"12000.0","client":"Sylvia Ssesaazi"},{"items":"[{product: 1L Juice, quantity: 2.0, totalPrice: 10000.0, description: Natural Juice }, {product: Delivery, quantity: 2.0, totalPrice: 5000.0, description: Delivery fee}]","date":"Monday, July, 2023, 11:28 AM","total":"15000.0","client":"Lynn ( URA)"},{"items":"[{product: 2L for 1 day , quantity: 3.0, totalPrice: 20000.0, description: 2L of detox }, {product: Delivery, quantity: 3.0, totalPrice: 5000.0, description: Delivery fee}]","date":"Monday, July, 2023, 01:49 PM","total":"25000.0","client":"Laura Dewaste"},{"items":"[{product: 1L Juice, quantity: 3.0, totalPrice: 10000.0, description: Natural Juice }, {product: Chicken Salad, quantity: 3.0, totalPrice: 18000.0, description: a nice chicken salad}]","date":"Monday, July, 2023, 11:28 AM","total":"28000.0","client":"Sharon (Ntinda Complex)"},{"items":"[{product: 2L for 1 day , quantity: 4.0, totalPrice: 20000.0, description: 2L of detox }]","date":"Tuesday, August, 2023, 12:00 AM","total":"20000.0","client":"Shallot (Kitghum House)"},{"items":"[{product: Chicken Salad, quantity: 1.0, totalPrice: 18000.0, description: Chicken Salad}, {product: 1L Juice, quantity: 1.0, totalPrice: 10000.0, description: Natural Juice }]","date":"Tuesday, August, 2023, 09:25 AM","total":"28000.0","client":"Ashley"},{"items":"[{product: 1L Juice, quantity: 1.0, totalPrice: 10000.0, description: Natural Juice }]","date":"Tuesday, August, 2023, 09:25 AM","total":"10000.0","client":"Ivan Musagazi"},{"items":"[{product: 1L Juice, quantity: 1.0, totalPrice: 10000.0, description: Natural Juice }, {product: Delivery, quantity: 1.0, totalPrice: 5000.0, description: Delivery fee}]","date":"Friday, August, 2023, 11:18 AM","total":"15000.0","client":"Lynn ( URA)"},{"items":"[{product: Chicken Salad, quantity: 1.0, totalPrice: 18000.0, description: a nice chicken salad}, {product: Delivery, quantity: 1.0, totalPrice: 2000.0, description: Delivery fee}]","date":"Friday, August, 2023, 11:20 AM","total":"20000.0","client":"Jamila"},{"items":"[{product: Chicken Salad, quantity: 1.0, totalPrice: 18000.0, description: a nice chicken salad}]","date":"Friday, August, 2023, 11:17 AM","total":"18000.0","client":"Martha (IOM)"},{"items":"[{product: 2L per day, quantity: 3.0, totalPrice: 20000.0, description: 2L of juice per day}, {product: Delivery, quantity: 3.0, totalPrice: 2000.0, description: Delivery fee}]","date":"Friday, August, 2023, 03:09 PM","total":"22000.0","client":"Sylvia Ssesaazi"},{"items":"[{product: 1L Detox Juice , quantity: 3, totalPrice: 10000, description: Detoxification }, {product: Delivery, quantity: 1, totalPrice: 4000, description: Delivery fee}]","date":"Wednesday, July, 2023, 05:53 PM","total":"14000.0","client":"Madam Carol"},{"items":"[{product: 1L Detox Juice , quantity: 1, totalPrice: 10000, description: 1L Detox Juice }, {product: Delivery, quantity: 1, totalPrice: 2000, description: Delivery}]","date":"Monday, July, 2023, 01:47 PM","total":"12000.0","client":"Barbara Uba "},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 day Detox (2L)}]","date":"Monday, July, 2023, 01:47 PM","total":"110000.0","client":"Mrs. Sebaalu"},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 day Detox (2L)}]","date":"Monday, July, 2023, 01:55 PM","total":"110000.0","client":"Lynn (URA)"},{"items":"[{product: 5 day Detox (2L), quantity: 2, totalPrice: 110000, description: 5 days of detox 2L per day}, {product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: Calc Test}]","date":"Monday, July, 2023, 03:44 PM","total":"220000.0","client":"Customer"},{"items":"[{product: 1L Detox Juice , quantity: 1, totalPrice: 10000, description: 1L Detox Juice }, {product: 1L Detox Juice , quantity: 1, totalPrice: 10000, description: 1L Detox Juice }]","date":"Monday, July, 2023, 01:58 PM","total":"20000.0","client":"Madam Carol"},{"items":"[{product: 5 day detox (1L), quantity: 8, totalPrice: 60000, description: 5 day detox 1L per day}]","date":"Tuesday, July, 2023, 07:54 AM","total":"60000.0","client":"Customer"},{"items":"[{product: Fresh Juice, quantity: 5, totalPrice: 10000, description: Juice}]","date":"Tuesday, July, 2023, 06:39 PM","total":"10000.0","client":"Barbara Uba "},{"items":"[{product: 1L Detox Juice , quantity: 3, totalPrice: 12000, description: Detoxification }]","date":"Tuesday, July, 2023, 01:19 PM","total":"12000.0","client":"Customer"},{"items":"[{product: Fresh Juice, quantity: 1, totalPrice: 10000, description: Mango Juice}]","date":"Tuesday, July, 2023, 12:58 PM","total":"10000.0","client":"Customer"},{"items":"[{product: Fresh Juice, quantity: 4, totalPrice: 12000, description: Juice}]","date":"Tuesday, July, 2023, 04:21 PM","total":"12000.0","client":"Jeremiah "},{"items":"[{product: Fresh Juice, quantity: 2, totalPrice: 12000, description: Juice}]","date":"Wednesday, July, 2023, 10:48 AM","total":"12000.0","client":"Lynn (URA)"},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 day Detox (2L)}]","date":"Tuesday, July, 2023, 08:27 AM","total":"110000.0","client":"Mrs. Sebaalu"},{"items":"[{product: Fresh Juice, quantity: 1, totalPrice: 10000, description: Fresh Juice}, {product: 5 day detox (1L), quantity: 1, totalPrice: 60000, description: 5 day detox (1L)}]","date":"Thursday, July, 2023, 09:36 PM","total":"70000.0","client":"Jamila"},{"items":"[{product: Fresh Juice, quantity: 1, totalPrice: 10000, description: Fresh Juice}]","date":"Thursday, July, 2023, 09:25 PM","total":"10000.0","client":"Jamila"},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 day Detox (2L)}]","date":"Thursday, July, 2023, 10:30 PM","total":"110000.0","client":"Mrs. Sebaalu"},{"items":"[{product: Chicken Salad, quantity: 1, totalPrice: 18000, description: Chicken Salad}, {product: Fresh Juice, quantity: 1, totalPrice: 10000, description: Fresh Juice}]","date":"Friday, July, 2023, 09:19 PM","total":"28000.0","client":"Mrs. Sebaalu"},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 day Detox (2L)}]","date":"Friday, July, 2023, 09:12 PM","total":"110000.0","client":"Jamila"},{"items":"[{product: Fresh Juice, quantity: 1, totalPrice: 10000, description: Fresh Juice}, {product: 5 day detox (1L), quantity: 1, totalPrice: 60000, description: 5 day detox (1L)}]","date":"Saturday, July, 2023, 07:26 PM","total":"70000.0","client":"Jamila"},{"items":"[{product: 5 day Detox (2L), quantity: 1, totalPrice: 110000, description: 5 day Detox (2L)}, {product: 5 day detox (1L), quantity: 1, totalPrice: 60000, description: 5 day detox (1L)}, {product: Fresh Juice, quantity: 1, totalPrice: 10000, description: Fresh Juice}]","date":"Saturday, July, 2023, 04:15 PM","total":"180000.0","client":"Jamila"}]';
  String data = '[{"items":"Fresh Juice","date":"Thursday, July, 2023, 12:00 AM","total":"10000.0","client":"Customer"},{"items":"Fresh Juice, 5 day detox (1L)","date":"Wednesday, July, 2023, 06:43 PM","total":"70000.0","client":"Madam Carol"},{"items":"Chicken Salad","date":"Wednesday, July, 2023, 07:56 PM","total":"18000.0","client":"Customer"},{"items":"Chicken Salad","date":"Wednesday, July, 2023, 08:32 PM","total":"18000.0","client":"Madam Carol"},{"items":"1L Detox Juice , 1L Detox Juice ","date":"Wednesday, July, 2023, 07:18 PM","total":"22000.0","client":"Mrs. Sebaalu"},{"items":"5 day detox (1L)","date":"Wednesday, July, 2023, 08:32 PM","total":"62000.0","client":"Barbara Uba "},{"items":"5 day Detox (2L)","date":"Thursday, July, 2023, 12:30 PM","total":"110000.0","client":"Jamila"},{"items":"Fresh Juice","date":"Thursday, July, 2023, 02:13 PM","total":"10000.0","client":"Customer"},{"items":"Fresh Juice, Chicken Salad","date":"Thursday, July, 2023, 03:02 AM","total":"28000.0","client":"Mrs. Sebaalu"},{"items":"Chicken Salad","date":"Thursday, July, 2023, 02:38 PM","total":"18000.0","client":"Customer"},{"items":"Chicken Salad","date":"Friday, July, 2023, 09:36 PM","total":"18000.0","client":"Jeremiah "},{"items":"Chicken Salad","date":"Friday, July, 2023, 05:47 PM","total":"18000.0","client":"Madam Carol"},{"items":"Fresh Juice","date":"Friday, July, 2023, 11:02 PM","total":"12000.0","client":"Barbara Uba "},{"items":"Fresh Juice","date":"Friday, July, 2023, 06:11 PM","total":"10000.0","client":"Barbara Uba "},{"items":"Chicken Salad, Chicken Salad","date":"Friday, July, 2023, 10:42 PM","total":"36000.0","client":"Lynn (URA)"},{"items":"Chicken Salad","date":"Friday, July, 2023, 06:08 PM","total":"18000.0","client":"Jeremiah "},{"items":"Chicken Salad","date":"Saturday, July, 2023, 12:40 PM","total":"18000.0","client":"Lynn (URA)"},{"items":"Chicken Salad","date":"Saturday, July, 2023, 11:20 PM","total":"18000.0","client":"Lynn (URA)"},{"items":"5 day Detox (2L)","date":"Monday, July, 2023, 08:34 AM","total":"110000.0","client":"Ethel "},{"items":"5 day detox (1L)","date":"Monday, July, 2023, 08:43 AM","total":"60000.0","client":"Lynn (Public Service)"},{"items":"1L Detox Juice , Delivery","date":"Monday, July, 2023, 08:33 AM","total":"12000.0","client":"Ashley"},{"items":"5 day Detox (2L)","date":"Monday, July, 2023, 08:31 AM","total":"110000.0","client":"Sylvia Ssesaazi"},{"items":"1L Juice, Delivery","date":"Monday, July, 2023, 08:46 AM","total":"15000.0","client":"Lynn ( URA)"},{"items":"5 day Detox (2L)","date":"Monday, July, 2023, 08:27 AM","total":"110000.0","client":"Beatrice URA "},{"items":"Chicken Salad","date":"Tuesday, July, 2023, 10:47 PM","total":"18000.0","client":"Bernard Kangave"},{"items":"Delivery","date":"Tuesday, July, 2023, 10:45 PM","total":"2000.0","client":"Bernard Kangave"},{"items":"1L Juice, Delivery","date":"Wednesday, July, 2023, 10:45 AM","total":"15000.0","client":"Lynn ( URA)"},{"items":"5 day Detox (2L)","date":"Wednesday, July, 2023, 10:49 AM","total":"110000.0","client":"Laura Dewaste"},{"items":"1L Juice","date":"Wednesday, July, 2023, 05:37 PM","total":"10000.0","client":"Hatima (Nabukeera)"},{"items":"1L Detox Juice , Delivery","date":"Thursday, July, 2023, 09:14 AM","total":"12000.0","client":"Noah "},{"items":"1L Juice, Delivery","date":"Thursday, July, 2023, 10:23 AM","total":"15000.0","client":"Lynn ( URA)"},{"items":"1L Juice, Delivery","date":"Friday, July, 2023, 10:45 AM","total":"13000.0","client":"Doreen Atukunda"},{"items":"1L Detox Juice ","date":"Friday, July, 2023, 02:47 PM","total":"10000.0","client":"Noah "},{"items":"1L Juice, Delivery","date":"Monday, July, 2023, 12:05 PM","total":"15000.0","client":"Lynn ( URA)"},{"items":"1L Juice","date":"Monday, July, 2023, 09:48 AM","total":"10000.0","client":"Noah "},{"items":"Fruit Salad , 1L Juice, Delivery","date":"Monday, July, 2023, 03:00 AM","total":"25000.0","client":"Ashley"},{"items":"1L for 5days","date":"Monday, July, 2023, 12:44 PM","total":"50000.0","client":"Hatima (Nabukeera)"},{"items":"1L for 5days","date":"Monday, July, 2023, 12:32 PM","total":"60000.0","client":"Sylvia Ssesaazi"},{"items":"5 day detox (1L)","date":"Monday, July, 2023, 10:40 AM","total":"60000.0","client":"Customer"},{"items":"2L for 1 day , 2L for 1 day , 2L for 1 day , 2L for 1 day ","date":"Friday, July, 2023, 01:11 PM","total":"80000.0","client":"Carol"},{"items":"1L Juice","date":"Thursday, July, 2023, 12:00 AM","total":"10000.0","client":"Customer"},{"items":"1L Juice","date":"Monday, July, 2023, 01:49 PM","total":"12000.0","client":"Sylvia Ssesaazi"},{"items":"1L Juice, Delivery","date":"Monday, July, 2023, 11:28 AM","total":"15000.0","client":"Lynn ( URA)"},{"items":"2L for 1 day , Delivery","date":"Monday, July, 2023, 01:49 PM","total":"25000.0","client":"Laura Dewaste"},{"items":"1L Juice, Chicken Salad","date":"Monday, July, 2023, 11:28 AM","total":"28000.0","client":"Sharon (Ntinda Complex)"},{"items":"2L for 1 day ","date":"Tuesday, August, 2023, 12:00 AM","total":"20000.0","client":"Shallot (Kitghum House)"},{"items":"Chicken Salad, 1L Juice","date":"Tuesday, August, 2023, 09:25 AM","total":"28000.0","client":"Ashley"},{"items":"1L Juice","date":"Tuesday, August, 2023, 09:25 AM","total":"10000.0","client":"Ivan Musagazi"},{"items":"1L Juice, Delivery","date":"Friday, August, 2023, 11:18 AM","total":"15000.0","client":"Lynn ( URA)"},{"items":"Chicken Salad, Delivery","date":"Friday, August, 2023, 11:20 AM","total":"20000.0","client":"Jamila"},{"items":"Chicken Salad","date":"Friday, August, 2023, 11:17 AM","total":"18000.0","client":"Martha (IOM)"},{"items":"2L per day, Delivery","date":"Friday, August, 2023, 03:09 PM","total":"22000.0","client":"Sylvia Ssesaazi"},{"items":"1L Detox Juice , Delivery","date":"Wednesday, July, 2023, 05:53 PM","total":"14000.0","client":"Madam Carol"},{"items":"1L Detox Juice , Delivery","date":"Monday, July, 2023, 01:47 PM","total":"12000.0","client":"Barbara Uba "},{"items":"5 day Detox (2L)","date":"Monday, July, 2023, 01:47 PM","total":"110000.0","client":"Mrs. Sebaalu"},{"items":"5 day Detox (2L)","date":"Monday, July, 2023, 01:55 PM","total":"110000.0","client":"Lynn (URA)"},{"items":"5 day Detox (2L), 5 day Detox (2L)","date":"Monday, July, 2023, 03:44 PM","total":"220000.0","client":"Customer"},{"items":"1L Detox Juice , 1L Detox Juice ","date":"Monday, July, 2023, 01:58 PM","total":"20000.0","client":"Madam Carol"},{"items":"5 day detox (1L)","date":"Tuesday, July, 2023, 07:54 AM","total":"60000.0","client":"Customer"},{"items":"Fresh Juice","date":"Tuesday, July, 2023, 06:39 PM","total":"10000.0","client":"Barbara Uba "},{"items":"1L Detox Juice ","date":"Tuesday, July, 2023, 01:19 PM","total":"12000.0","client":"Customer"},{"items":"Fresh Juice","date":"Tuesday, July, 2023, 12:58 PM","total":"10000.0","client":"Customer"},{"items":"Fresh Juice","date":"Tuesday, July, 2023, 04:21 PM","total":"12000.0","client":"Jeremiah "},{"items":"Fresh Juice","date":"Wednesday, July, 2023, 10:48 AM","total":"12000.0","client":"Lynn (URA)"},{"items":"5 day Detox (2L)","date":"Tuesday, July, 2023, 08:27 AM","total":"110000.0","client":"Mrs. Sebaalu"},{"items":"Fresh Juice, 5 day detox (1L)","date":"Thursday, July, 2023, 09:36 PM","total":"70000.0","client":"Jamila"},{"items":"Fresh Juice","date":"Thursday, July, 2023, 09:25 PM","total":"10000.0","client":"Jamila"},{"items":"5 day Detox (2L)","date":"Thursday, July, 2023, 10:30 PM","total":"110000.0","client":"Mrs. Sebaalu"},{"items":"Chicken Salad, Fresh Juice","date":"Friday, July, 2023, 09:19 PM","total":"28000.0","client":"Mrs. Sebaalu"},{"items":"5 day Detox (2L)","date":"Friday, July, 2023, 09:12 PM","total":"110000.0","client":"Jamila"},{"items":"Fresh Juice, 5 day detox (1L)","date":"Saturday, July, 2023, 07:26 PM","total":"70000.0","client":"Jamila"},{"items":"5 day Detox (2L), 5 day detox (1L), Fresh Juice","date":"Saturday, July, 2023, 04:15 PM","total":"180000.0","client":"Jamila"}]';
  void defaultInitialization()async{
    final prefs = await SharedPreferences.getInstance();
    storeName = prefs.getString(kBusinessNameConstant)!;
    storeId = prefs.getString(kStoreIdConstant)!;

    setState(() {

    });
  }


  @override
  void initState() {
    // TODO: implement initState
    super.initState();
    defaultInitialization();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: backgroundColor,
      appBar: AppBar(
        backgroundColor: kPureWhiteColor,
        elevation: 0,
        automaticallyImplyLeading: false,
       leading:   GestureDetector(
         onTap: (){
           Navigator.pop(context);
           Navigator.pop(context);
           Navigator.pushNamed(context, SuperResponsiveLayout.id);
         },
         child: Icon(Icons.cancel),
       ),

      ),
      floatingActionButton: FloatingActionButton.extended(
        splashColor: kCustomColor,
        // foregroundColor: Colors.black,
        backgroundColor: kAppPinkColor,
        //blendedData.saladButtonColour,
        onPressed: () async {
          // try {
          //   dynamic serverCallableVariable = await callableCreateStoreAnalysis.call(<String, dynamic>{
          //     'business': storeName,
          //     'storeId': storeId,
          //     'info': data,
          //   }).whenComplete(() =>  Navigator.push(context,
          //       MaterialPageRoute(builder: (context)=> LoadingAnalysisPage())
          //   ));
          //   // Handle the serverCallableVariable if the request is successful
          //   // For example, you can print the response or use it as needed.
          // } catch (error) {
          //   print('Error message: ${error.toString()}');
          //   // Handle the error here or propagate it further if needed.
          // }
          Navigator.pop(context);
          Navigator.pushNamed(context, LoadingAnalysisPage.id);
          // MaterialPageRoute(builder: (context)=> LoadingAnalysisPage());
        },
      //   Additionally, I noticed that you are using the catchError method to handle errors. If you want to handle errors using the catchError method, you should return a value from the error handler, but it's often recommended to use the try-catch block for async/await functions for better readability and control.
      //
      // If the issue persists after making this change, there might be other factors causing the error. You can try debugging the Firebase Functions code and check if there are any issues there. Also, ensure that the data being passed to the Cloud Function is in the correct format and matches the expected parameters.
      //
      // Remember to check your server logs for any potential errors or additional information that might help diagnose the issue further.






        icon: Icon(Icons.graphic_eq, color: kPureWhiteColor,) ,
        label: Text(
          'See Anayltics',
          style: kNormalTextStyle.copyWith(color: kPureWhiteColor),
        ),
      ),
      floatingActionButtonLocation: FloatingActionButtonLocation.miniCenterFloat,
      body: WillPopScope(
        onWillPop: () async {
          return false; // return a `Future` with false value so this route cant be popped or closed.
        },
        child: SingleChildScrollView(
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.stretch,
            children: [
              Padding(
                padding: const EdgeInsets.all(8.0),
                child: Center(child: Text("Understand $storeName\n Deeply",textAlign: TextAlign.center, style: kHeading2TextStyleBold.copyWith(fontSize: 20),)),
              ),
              // const SizedBox(height: 6.0),
              Container(
                height: 250,
                width: double.infinity,
                color: kPureWhiteColor,
                child: Lottie.asset("images/analysis.json"),
              ),
              kLargeHeightSpacing,

              // ),
              const SizedBox(height: 8.0),
              _buildFeatureList(
                Icons.check_circle_outline,
                'Know your best and worst performing Products',
              ),
              _buildFeatureList(
                Icons.check_circle_outline,
                'Know and reward your best Customers',
              ),
              _buildFeatureList(
                Icons.check_circle_outline,
                'Adjust your marketing plan based on real data',
              ),

              // Padding(
              //   padding: const EdgeInsets.all(8.0),
              //   child: DesignedButton(continueFunction: () async {
              //     final prefs = await SharedPreferences.getInstance();
              //     // prefs.setBool(kFirstTimePhoto, false);
              //
              //     Navigator.pop(context);
              //
              //
              //
              //   }, title: "Continue"),
              // )

            ],
          ),
        ),
      ),
    );
  }


  Widget _buildFeatureList(IconData icon, String text) {
    return Padding(
      padding: const EdgeInsets.only(left: 20.0, bottom: 10),
      child: Row(

        children: [
          Icon(
            icon,
            color: kAppPinkColor,
          ),
          SizedBox(width: 8.0),
          Flexible(child: Text(text, overflow: TextOverflow.visible, style: kNormalTextStyle.copyWith(color: kBlack, fontSize: 17),)),
        ],
      ),
    );
  }
}

